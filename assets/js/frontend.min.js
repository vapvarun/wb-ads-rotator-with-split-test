(()=>{var l={cookies:{get:function(e){e=("; "+document.cookie).split("; "+e+"=");return 2===e.length?e.pop().split(";").shift():null},set:function(e,t,n){var o,i="";n&&((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),i="; expires="+o.toUTCString()),document.cookie=e+"="+(t||"")+i+"; path=/"},getClosedAds:function(){var e=this.get("wbam_closed_ads");if(e)try{return JSON.parse(e)}catch(e){}return[]},markClosed:function(e){var t=this.getClosedAds();-1===t.indexOf(e)&&t.push(e),this.set("wbam_closed_ads",JSON.stringify(t),1)},isClosed:function(e){return-1!==this.getClosedAds().indexOf(e)}},sticky:{init:function(){document.querySelectorAll(".wbam-sticky-ad").forEach(function(t){var e,n=parseInt(t.getAttribute("data-ad-id"),10);l.cookies.isClosed(n)?t.style.display="none":(e=t.querySelector(".wbam-sticky-close"))&&e.addEventListener("click",function(e){e.preventDefault(),t.style.display="none",l.cookies.markClosed(n)})})}},popup:{shown:[],init:function(){document.querySelectorAll(".wbam-popup-overlay").forEach(function(t){var n=parseInt(t.getAttribute("data-ad-id"),10),e=t.getAttribute("data-trigger"),o=parseInt(t.getAttribute("data-delay"),10)||5,i=parseInt(t.getAttribute("data-scroll"),10)||50;if(!l.cookies.isClosed(n)){var a=t.querySelector(".wbam-popup-close");switch(a&&a.addEventListener("click",function(e){e.preventDefault(),l.popup.close(t,n)}),t.addEventListener("click",function(e){e.target===t&&l.popup.close(t,n)}),document.addEventListener("keydown",function(e){"Escape"===e.key&&"none"!==t.style.display&&l.popup.close(t,n)}),e){case"delay":l.popup.setupDelayTrigger(t,n,o);break;case"scroll":l.popup.setupScrollTrigger(t,n,i);break;case"exit":l.popup.setupExitTrigger(t,n)}}})},show:function(e,t){-1===this.shown.indexOf(t)&&(this.shown.push(t),e.style.display="flex",document.body.style.overflow="hidden")},close:function(e,t){e.style.display="none",document.body.style.overflow="",l.cookies.markClosed(t)},setupDelayTrigger:function(e,t,n){var o=this;setTimeout(function(){o.show(e,t)},1e3*n)},setupScrollTrigger:function(n,o,i){function a(){var e,t;s||(e=window.pageYOffset||document.documentElement.scrollTop,t=document.documentElement.scrollHeight-window.innerHeight,i<=e/t*100&&(s=!0,r.show(n,o),window.removeEventListener("scroll",a)))}var r=this,s=!1;window.addEventListener("scroll",a)},setupExitTrigger:function(t,n){function o(e){a||e.clientY<=0&&(a=!0,i.show(t,n),document.removeEventListener("mouseout",o))}var i=this,a=!1;setTimeout(function(){document.addEventListener("mouseout",o)},2e3)}},lazy:{init:function(){var t,e=document.querySelectorAll(".wbam-lazy");"IntersectionObserver"in window?(t=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&((e=e.target).classList.add("wbam-loaded"),t.unobserve(e))})},{rootMargin:"100px"}),e.forEach(function(e){t.observe(e)})):e.forEach(function(e){e.classList.add("wbam-loaded")})}},emailCapture:{init:function(){document.querySelectorAll(".wbam-ad-email-capture").forEach(function(t){var n=parseInt(t.getAttribute("data-ad-id"),10),o=parseInt(t.getAttribute("data-cookie-days"),10)||7,i=t.querySelector(".wbam-email-form"),e=t.querySelector(".wbam-email-close");e&&e.addEventListener("click",function(e){e.preventDefault(),l.emailCapture.dismiss(t,n,o)}),i&&i.addEventListener("submit",function(e){e.preventDefault(),l.emailCapture.submit(i,t,n,o)})})},dismiss:function(e,t,n){e.style.display="none",0<n&&l.cookies.set("wbam_email_dismiss_"+t,"1",n)},submit:function(t,n,o,i){var a,r=t.querySelector(".wbam-email-button"),s=n.querySelector(".wbam-email-success"),c=n.querySelector(".wbam-email-error"),d=n.querySelector(".wbam-email-error-message"),e=new FormData(t);window.wbamFrontend&&(n.classList.add("wbam-loading"),r&&(r.disabled=!0),c&&(c.style.display="none"),(a=new XMLHttpRequest).open("POST",window.wbamFrontend.ajaxUrl,!0),a.onreadystatechange=function(){if(4===a.readyState){var e;n.classList.remove("wbam-loading"),r&&(r.disabled=!1);try{e=JSON.parse(a.responseText)}catch(e){return void l.emailCapture.showError(c,d,"An error occurred. Please try again.")}e.success?(0<i&&l.cookies.set("wbam_email_dismiss_"+o,"1",i),e.data&&e.data.redirect?window.location.href=e.data.redirect:(t.style.display="none",s&&(s.style.display="block"),setTimeout(function(){n.style.display="none"},5e3))):(e=e.data&&e.data.message?e.data.message:"An error occurred. Please try again.",l.emailCapture.showError(c,d,e))}},e=new URLSearchParams(e).toString(),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(e))},showError:function(e,t,n){e&&t&&(t.textContent=n,e.style.display="block")}},clicks:{init:function(){document.querySelectorAll(".wbam-ad-container[data-ad-id]").forEach(function(t){t.querySelectorAll("a").forEach(function(e){e.addEventListener("click",function(){l.clicks.track(t)})})})},track:function(e){var t,n=e.getAttribute("data-ad-id"),e=e.getAttribute("data-placement")||"";n&&window.wbamFrontend&&((t=new XMLHttpRequest).open("POST",window.wbamFrontend.ajaxUrl,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("action=wbam_track_click&ad_id="+encodeURIComponent(n)+"&placement="+encodeURIComponent(e)+"&nonce="+encodeURIComponent(window.wbamFrontend.nonce)))}},init:function(){this.sticky.init(),this.popup.init(),this.lazy.init(),this.clicks.init(),this.emailCapture.init()}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){l.init()}):l.init()})();